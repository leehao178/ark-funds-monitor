{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Danny\\\\Documents\\\\GitHub\\\\ark-funds-monitor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Danny\\\\Documents\\\\GitHub\\\\ark-funds-monitor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Danny\\\\Documents\\\\GitHub\\\\ark-funds-monitor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Danny\\\\Documents\\\\GitHub\\\\ark-funds-monitor\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import*as _ from'lodash';import ReactEcharts from'echarts-for-react';import{CircularProgress,Grid}from'@material-ui/core';import{ToggleButtonGroup,ToggleButton}from'@material-ui/lab';import*as Consts from'../../../shared/constants';import{tickerService,errorMessageService}from'../../../services/generic-service';import'./stock-figure.scss';var arkData=require('../../../rawData/mergedData.json');var downColor='#FF5000';var downBorderColor='#8A0000';var upColor='#00C805';var upBorderColor='#008F28';var StockFigure=/*#__PURE__*/function(_React$Component){_inherits(StockFigure,_React$Component);var _super=_createSuper(StockFigure);function StockFigure(props){var _this;_classCallCheck(this,StockFigure);_this=_super.call(this,props);_this.handleCandlestickDaysRangeChange=function(event,newValue){if(newValue!==_this.state.candlestickDaysRange&&_this.state.massagedData.length>0){_this.setState({candlestickDaysRange:newValue});_this.getCandleData(_this.state.ticker,newValue);}};_this.state={ticker:'',figureTitle:'',candlestickDaysRange:90,isFigureLoading:false,massagedData:[],figureRangeButtonConfigs:[{id:'1D',text:'1D',value:1,resolution:'5',daysRange:1},{id:'1W',text:'1W',value:7,resolution:'D',daysRange:7},{id:'2W',text:'2W',value:14,resolution:'D',daysRange:14},{id:'1M',text:'1M',value:30,resolution:'D',daysRange:30},{id:'3M',text:'3M',value:90,resolution:'D',daysRange:90},{id:'1Y',text:'1Y',value:365,resolution:'D',daysRange:365}]};_this.props=props;return _this;}_createClass(StockFigure,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.tickerSubscription=tickerService.getTicker().subscribe(function(ticker){if(ticker){_this2.setState({ticker:ticker});_this2.getCandleData(ticker,_this2.state.candlestickDaysRange);}else{_this2.setState({ticker:''});}});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.tickerSubscription.unsubscribe();}},{key:\"getCandleData\",value:function getCandleData(ticker,daysRange){var _this3=this;errorMessageService.changeErrorMessage('');this.setState({isFigureLoading:true});// let that = this;\nvar endDate=new Date().setHours(0,0,0,0)/1000;var startDate=endDate-daysRange*24*60*60;var resolution=this.state.figureRangeButtonConfigs.find(function(x){return x.value===daysRange;}).resolution;var apiParams={symbol:ticker,resolution:resolution,from:startDate,to:endDate,token:Consts.token};var paramsArray=[];for(var prop in apiParams){paramsArray.push(\"\".concat(prop,\"=\").concat(apiParams[prop]));}var getCandleUrl=Consts.getCandleUrl+paramsArray.join('&');fetch(getCandleUrl,{method:'GET'}).then(function(response){if(!response.ok){if(response.status===429){errorMessageService.changeErrorMessage(\"Too Many Requests, Please Wait\");}throw new Error(\"HTTP status \"+response.status);}return response.json();}).then(function(data){if(data&&data.s==='ok'){var massaged=[];for(var i=0;i<data.t.length;i++){var row=[];var time='';if(resolution==='D'){time=new Date(data.t[i]*1000).toISOString().split(\"T\")[0];}else if(typeof parseInt(resolution)==='number'){var temp=new Date(data.t[i]*1000);time=new Date(temp.setMinutes(temp.getMinutes()-240)).toLocaleTimeString(\"en-US\");}row.push(time,Math.round(data.o[i]*100)/100,Math.round(data.c[i]*100)/100,Math.round(data.l[i]*100)/100,Math.round(data.h[i]*100)/100,data.v[i]);massaged.push(row);}_this3.setState({figureTitle:ticker});_this3.setState({massagedData:massaged});}if(data.s==='no_data'){errorMessageService.changeErrorMessage(\"API returned 'NO DATA' for \".concat(ticker));}_this3.setState({isFigureLoading:false});}).catch(function(error){return _this3.setState({error:error});});}},{key:\"splitData\",value:function splitData(rawData){var categoryData=[];var values=[];var volumes=[];for(var i=0;i<rawData.length;i++){categoryData.push(rawData[i].splice(0,1)[0]);values.push(rawData[i]);volumes.push([i,rawData[i][4],rawData[i][0]>rawData[i][1]?1:-1]);;}return{categoryData:categoryData,values:values,volumes:volumes};}},{key:\"calculateMA\",value:function calculateMA(dayCount){var result=[];for(var i=0,len=this.data.values.length;i<len;i++){if(i<dayCount){result.push('-');continue;}var sum=0;for(var j=0;j<dayCount;j++){sum+=this.data.values[i-j][1];}result.push(Math.round(sum/dayCount*100)/100);}return result;}},{key:\"getOption\",value:function getOption(){var _this4=this;this.data=this.splitData(_.cloneDeep(this.state.massagedData));var option={backgroundColor:'#fff',title:{text:this.state.figureTitle,left:'2%',top:'-1%',textStyle:{color:'#000',fontSize:20}},tooltip:{trigger:'axis',axisPointer:{animation:false,type:'cross',label:{fontSize:16},lineStyle:{color:'#376df4',width:2,opacity:1}},textStyle:{fontSize:16}},legend:{data:['Day'],inactiveColor:'#777',textStyle:{color:'#000',fontSize:16},top:'3%'},axisPointer:{link:{xAxisIndex:'all'},label:{backgroundColor:'#777'}},toolbox:{show:false,feature:{dataZoom:{yAxisIndex:false},brush:{type:['lineX','clear']}}},visualMap:{show:false,seriesIndex:1,dimension:2,pieces:[{value:1,color:downColor},{value:-1,color:upColor}]},grid:[{bottom:'30%'},{height:'15%',bottom:'10%'}],xAxis:[{type:'category',data:this.data.categoryData,scale:true,boundaryGap:false,axisLine:{onZero:false,lineStyle:{color:'#000'}},splitLine:{show:false},splitNumber:20,min:'dataMin',max:'dataMax',axisLabel:{show:true,textStyle:{fontSize:14}}},{type:'category',gridIndex:1,data:this.data.categoryData,scale:true,boundaryGap:false,axisLine:{onZero:false,lineStyle:{color:'#8392A5'}},axisTick:{show:false},splitLine:{show:false},axisLabel:{show:false},splitNumber:20,min:'dataMin',max:'dataMax'}],yAxis:[{scale:true,splitArea:{show:true},axisLine:{lineStyle:{color:'#000'}},splitLine:{show:false},axisLabel:{show:true,textStyle:{fontSize:14}}},{scale:true,gridIndex:1,splitNumber:2,axisLabel:{show:false},axisLine:{show:false,lineStyle:{color:'#000'}},axisTick:{show:false},splitLine:{show:false}}],dataZoom:[{type:'inside',start:0,end:100},{show:true,type:'slider',bottom:'2%',start:0,end:100,textStyle:{color:'#8392A5'},handleIcon:'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',handleSize:'80%',dataBackground:{areaStyle:{color:'#8392A5'},lineStyle:{opacity:0.8,color:'#8392A5'}},handleStyle:{color:'#fff',shadowBlur:3,shadowColor:'rgba(0, 0, 0, 0.6)',shadowOffsetX:2,shadowOffsetY:2}}],series:[{name:'Day',type:'candlestick',data:this.data.values,itemStyle:{color:upColor,color0:downColor,borderColor:upBorderColor,borderColor0:downBorderColor},markPoint:{label:{normal:{formatter:function formatter(param){if(typeof param==='number'){return param!=null?Math.round(param.value):'';}}}},data:[{name:'highest value',type:'max',valueDim:'highest',symbolOffset:[0,-30],itemStyle:{color:'#FCAE1E'}},{name:'lowest value',type:'min',valueDim:'lowest',symbolOffset:[0,-30],itemStyle:{color:'#FCAE1E'}}// {\n//     name: 'average value on close',\n//     type: 'average',\n//     valueDim: 'close',\n//     symbolOffset: [0, -20]\n// }\n],tooltip:{formatter:function formatter(param){return param.name+'<br>'+(param.data.coord||'');}}},markLine:{symbol:['none','none'],lineStyle:{color:downColor},data:[[{name:'from lowest to highest',type:'min',valueDim:'lowest',symbol:'circle',symbolSize:10,label:{show:false},emphasis:{label:{show:false}}},{type:'max',valueDim:'highest',symbol:'circle',symbolSize:10,label:{show:false},emphasis:{label:{show:false}}}],{name:'min line on close',type:'min',valueDim:'close'},{name:'max line on close',type:'max',valueDim:'close'}]}},{name:'Volume',type:'bar',xAxisIndex:1,yAxisIndex:1,data:this.data.volumes}]};// If resolution !== 'D' skip ARK history mark points and MA lines\nif(this.state.figureRangeButtonConfigs.find(function(x){return x.value===_this4.state.candlestickDaysRange;}).resolution!=='D'){return option;}// add MA lines according to candlestickDaysRange\nif(this.state.candlestickDaysRange>=10){option.series.push({name:'MA5',type:'line',data:this.calculateMA(5),smooth:true,lineStyle:{opacity:0.5},itemStyle:{color:'#0000FF'}});option.legend.data.push('MA5');}if(this.state.candlestickDaysRange>=20){option.series.push({name:'MA10',type:'line',data:this.calculateMA(10),smooth:true,lineStyle:{opacity:0.5},itemStyle:{color:'#FFAE19'}});option.legend.data.push('MA10');}if(this.state.candlestickDaysRange>=40){option.series.push({name:'MA20',type:'line',data:this.calculateMA(20),smooth:true,lineStyle:{opacity:0.5},itemStyle:{color:'#FF00FF'}});option.legend.data.push('MA20');}// handle mark point for BUY/SELL from ARK\nvar filteredArkData=arkData.filter(function(x){return x.Ticker===_this4.state.figureTitle;});if(!filteredArkData||filteredArkData.length===0){return option;}var groupMap=_.groupBy(filteredArkData,'Date');var _loop=function _loop(date){var dataArrayInDate=groupMap[date];var dataInProps=_this4.state.massagedData.find(function(m){return m[0]===dataArrayInDate[0].Date;});if(!(dataInProps&&dataInProps[4])){return\"continue\";}var buyCount=dataArrayInDate.filter(function(x){return x.Direction==='Buy';}).length;var sellCount=dataArrayInDate.length-buyCount;if(buyCount===0||sellCount===0){var pointText='';if(buyCount===0){pointText=sellCount===1?\"\".concat(dataArrayInDate[0].Direction):\"Sell\\nX\".concat(sellCount);}else if(sellCount===0){pointText=buyCount===1?\"\".concat(dataArrayInDate[0].Direction):\"Buy\\nX\".concat(buyCount);}option.series[0].markPoint.data.push({name:\"\".concat(dataArrayInDate[0].Date,\" \").concat(dataArrayInDate[0].Direction),coord:[dataArrayInDate[0].Date,dataInProps[4]],value:pointText,itemStyle:{color:buyCount===0?'#FF5000':'#00C805'}});}else{// have buyCount > 0 and sellCount > 0\noption.series[0].markPoint.data.push({name:\"\".concat(dataArrayInDate[0].Date,\" Buy\"),coord:[dataArrayInDate[0].Date,dataInProps[4]],value:\"Buy\\nX\".concat(buyCount),itemStyle:{color:'#00C805'}});option.series[0].markPoint.data.push({name:\"\".concat(dataArrayInDate[0].Date,\" Sell\"),coord:[dataArrayInDate[0].Date,dataInProps[4]*1.1],value:\"Sell\\n\".concat(sellCount),itemStyle:{color:'#FF5000'}});}};for(var date in groupMap){var _ret=_loop(date);if(_ret===\"continue\")continue;}return option;}},{key:\"render\",value:function render(){var subComponent;if(this.state.isFigureLoading===true){subComponent=/*#__PURE__*/React.createElement(\"div\",{className:\"loader-wrapper\"},/*#__PURE__*/React.createElement(CircularProgress,null));}else if(this.state.massagedData.length>0){// const fullRangePercentage = this.state.massagedData[this.state.massagedData.length - 1][2] / this.state.massagedData.data[0][2] - 1;\n// const halfRangePercentage = this.state.massagedData[this.state.massagedData.length - 1][2] / this.state.massagedData.data[Math.round((this.state.massagedData.data.length - 1) / 2)][2] - 1;\n// let fullRangeChange = (fullRangePercentage < 0 ? \"\" : \"+\") + (fullRangePercentage * 100).toFixed(2) + '%'\n// let halfRangeChange = (halfRangePercentage < 0 ? \"\" : \"+\") + (halfRangePercentage * 100).toFixed(2) + '%'\nsubComponent=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ReactEcharts,{option:this.getOption(),notMerge:true,lazyUpdate:true,style:{height:'400px',width:'100%'}}),/*#__PURE__*/React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\"},/*#__PURE__*/React.createElement(ToggleButtonGroup,{className:\"toggle-button-group\",value:this.state.candlestickDaysRange,exclusive:true,onChange:this.handleCandlestickDaysRangeChange,\"aria-label\":\"figure-range-button-group\"},this.state.figureRangeButtonConfigs.map(function(button){return/*#__PURE__*/React.createElement(ToggleButton,{key:button.id,value:button.value,\"aria-label\":\"toggle-button-\".concat(button.id)},button.text);}))));}else{subComponent=/*#__PURE__*/React.createElement(\"div\",{className:\"chart-placeholder\"},/*#__PURE__*/React.createElement(\"p\",null,\"Search Any Ticker/Tap Any Card/Tap Any Row\",/*#__PURE__*/React.createElement(\"br\",null),\"Candlestick Chart Will Display Below\"),/*#__PURE__*/React.createElement(\"svg\",{width:\"3em\",height:\"3em\",viewBox:\"0 0 16 16\",className:\"bi bi-chevron-double-down\",fill:\"currentColor\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"path\",{d:\"M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z\"}),/*#__PURE__*/React.createElement(\"path\",{d:\"M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z\"})));}return/*#__PURE__*/React.createElement(\"div\",null,subComponent);}}]);return StockFigure;}(React.Component);export default StockFigure;","map":{"version":3,"sources":["C:/Users/Danny/Documents/GitHub/ark-funds-monitor/src/components/stock-details/stock-figure/stock-figure.js"],"names":["React","_","ReactEcharts","CircularProgress","Grid","ToggleButtonGroup","ToggleButton","Consts","tickerService","errorMessageService","arkData","require","downColor","downBorderColor","upColor","upBorderColor","StockFigure","props","handleCandlestickDaysRangeChange","event","newValue","state","candlestickDaysRange","massagedData","length","setState","getCandleData","ticker","figureTitle","isFigureLoading","figureRangeButtonConfigs","id","text","value","resolution","daysRange","tickerSubscription","getTicker","subscribe","unsubscribe","changeErrorMessage","endDate","Date","setHours","startDate","find","x","apiParams","symbol","from","to","token","paramsArray","prop","push","getCandleUrl","join","fetch","method","then","response","ok","status","Error","json","data","s","massaged","i","t","row","time","toISOString","split","parseInt","temp","setMinutes","getMinutes","toLocaleTimeString","Math","round","o","c","l","h","v","catch","error","rawData","categoryData","values","volumes","splice","dayCount","result","len","sum","j","splitData","cloneDeep","option","backgroundColor","title","left","top","textStyle","color","fontSize","tooltip","trigger","axisPointer","animation","type","label","lineStyle","width","opacity","legend","inactiveColor","link","xAxisIndex","toolbox","show","feature","dataZoom","yAxisIndex","brush","visualMap","seriesIndex","dimension","pieces","grid","bottom","height","xAxis","scale","boundaryGap","axisLine","onZero","splitLine","splitNumber","min","max","axisLabel","gridIndex","axisTick","yAxis","splitArea","start","end","handleIcon","handleSize","dataBackground","areaStyle","handleStyle","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","series","name","itemStyle","color0","borderColor","borderColor0","markPoint","normal","formatter","param","valueDim","symbolOffset","coord","markLine","symbolSize","emphasis","calculateMA","smooth","filteredArkData","filter","Ticker","groupMap","groupBy","date","dataArrayInDate","dataInProps","m","buyCount","Direction","sellCount","pointText","subComponent","getOption","map","button","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport * as _ from 'lodash';\r\nimport ReactEcharts from 'echarts-for-react';\r\nimport {\r\n    CircularProgress, Grid\r\n} from '@material-ui/core';\r\nimport { ToggleButtonGroup, ToggleButton } from '@material-ui/lab';\r\n\r\nimport * as Consts from '../../../shared/constants';\r\nimport { tickerService, errorMessageService } from '../../../services/generic-service';\r\nimport './stock-figure.scss';\r\n\r\nlet arkData = require('../../../rawData/mergedData.json');\r\n\r\nvar downColor = '#FF5000';\r\nvar downBorderColor = '#8A0000';\r\nvar upColor = '#00C805';\r\nvar upBorderColor = '#008F28';\r\n\r\nclass StockFigure extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            ticker: '',\r\n            figureTitle: '',\r\n            candlestickDaysRange: 90,\r\n            isFigureLoading: false,\r\n            massagedData: [],\r\n            figureRangeButtonConfigs: [\r\n                { id: '1D', text: '1D', value: 1, resolution: '5', daysRange: 1 },\r\n                { id: '1W', text: '1W', value: 7, resolution: 'D', daysRange: 7 },\r\n                { id: '2W', text: '2W', value: 14, resolution: 'D', daysRange: 14 },\r\n                { id: '1M', text: '1M', value: 30, resolution: 'D', daysRange: 30 },\r\n                { id: '3M', text: '3M', value: 90, resolution: 'D', daysRange: 90 },\r\n                { id: '1Y', text: '1Y', value: 365, resolution: 'D', daysRange: 365 }\r\n            ]\r\n        };\r\n        this.props = props;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.tickerSubscription = tickerService.getTicker().subscribe(ticker => {\r\n            if (ticker) {\r\n                this.setState({ ticker: ticker });\r\n                this.getCandleData(ticker, this.state.candlestickDaysRange);\r\n            } else {\r\n                this.setState({ ticker: '' });\r\n            }\r\n        });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.tickerSubscription.unsubscribe();\r\n    }\r\n\r\n    getCandleData(ticker, daysRange) {\r\n        errorMessageService.changeErrorMessage('');\r\n        this.setState({ isFigureLoading: true });\r\n\r\n\r\n        // let that = this;\r\n        let endDate = new Date().setHours(0, 0, 0, 0) / 1000;\r\n        let startDate = endDate - daysRange * 24 * 60 * 60;\r\n        let resolution = this.state.figureRangeButtonConfigs.find(x => x.value === daysRange).resolution;\r\n\r\n        const apiParams = {\r\n            symbol: ticker,\r\n            resolution: resolution,\r\n            from: startDate,\r\n            to: endDate,\r\n            token: Consts.token\r\n        };\r\n        let paramsArray = [];\r\n        for (let prop in apiParams) {\r\n            paramsArray.push(`${prop}=${apiParams[prop]}`);\r\n        }\r\n        let getCandleUrl = Consts.getCandleUrl + paramsArray.join('&');\r\n\r\n        fetch(getCandleUrl, {\r\n            method: 'GET'\r\n        })\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    if (response.status === 429) {\r\n                        errorMessageService.changeErrorMessage(`Too Many Requests, Please Wait`);\r\n                    }\r\n                    throw new Error(\"HTTP status \" + response.status);\r\n                }\r\n                return response.json();\r\n            })\r\n            .then((data) => {\r\n                if (data && data.s === 'ok') {\r\n                    let massaged = [];\r\n                    for (let i = 0; i < data.t.length; i++) {\r\n                        let row = [];\r\n                        let time = '';\r\n                        if (resolution === 'D') {\r\n                            time = new Date(data.t[i] * 1000).toISOString().split(\"T\")[0]\r\n                        } else if (typeof(parseInt(resolution)) === 'number') {\r\n                            const temp = new Date(data.t[i] * 1000);\r\n                            time = new Date(temp.setMinutes(temp.getMinutes() - 240)).toLocaleTimeString(\"en-US\");\r\n                        }\r\n\r\n                        row.push(\r\n                            time,\r\n                            Math.round(data.o[i] * 100) / 100,\r\n                            Math.round(data.c[i] * 100) / 100,\r\n                            Math.round(data.l[i] * 100) / 100,\r\n                            Math.round(data.h[i] * 100) / 100,\r\n                            data.v[i],\r\n                        )\r\n                        massaged.push(row);\r\n                    }\r\n\r\n                    this.setState({ figureTitle: ticker });\r\n                    this.setState({ massagedData: massaged });\r\n                }\r\n\r\n                if (data.s === 'no_data') {\r\n                    errorMessageService.changeErrorMessage(`API returned 'NO DATA' for ${ticker}`);\r\n                }\r\n\r\n                this.setState({ isFigureLoading: false });\r\n            })\r\n            .catch(error => this.setState({ error }));\r\n    }\r\n\r\n    splitData(rawData) {\r\n        var categoryData = [];\r\n        var values = [];\r\n        var volumes = [];\r\n\r\n        for (var i = 0; i < rawData.length; i++) {\r\n            categoryData.push(rawData[i].splice(0, 1)[0]);\r\n            values.push(rawData[i]);\r\n            volumes.push([i, rawData[i][4], rawData[i][0] > rawData[i][1] ? 1 : -1]);;\r\n        }\r\n        return {\r\n            categoryData: categoryData,\r\n            values: values,\r\n            volumes: volumes\r\n        };\r\n    }\r\n\r\n    calculateMA(dayCount) {\r\n        var result = [];\r\n        for (var i = 0, len = this.data.values.length; i < len; i++) {\r\n            if (i < dayCount) {\r\n                result.push('-');\r\n                continue;\r\n            }\r\n            var sum = 0;\r\n            for (var j = 0; j < dayCount; j++) {\r\n                sum += this.data.values[i - j][1];\r\n            }\r\n            result.push(Math.round(sum / dayCount * 100) / 100);\r\n        }\r\n        return result;\r\n    }\r\n\r\n\r\n    getOption() {\r\n        this.data = this.splitData(_.cloneDeep(this.state.massagedData));\r\n        let option = {\r\n            backgroundColor: '#fff',\r\n            title: {\r\n                text: this.state.figureTitle,\r\n                left: '2%',\r\n                top: '-1%',\r\n                textStyle: {\r\n                    color: '#000',\r\n                    fontSize: 20\r\n                },\r\n            },\r\n            tooltip: {\r\n                trigger: 'axis',\r\n                axisPointer: {\r\n                    animation: false,\r\n                    type: 'cross',\r\n                    label: {\r\n                        fontSize: 16\r\n                    },\r\n                    lineStyle: {\r\n                        color: '#376df4',\r\n                        width: 2,\r\n                        opacity: 1\r\n                    }\r\n                },\r\n                textStyle: {\r\n                    fontSize: 16\r\n                }\r\n            },\r\n            legend: {\r\n                data: ['Day'],\r\n                inactiveColor: '#777',\r\n                textStyle: {\r\n                    color: '#000',\r\n                    fontSize: 16\r\n                },\r\n                top: '3%',\r\n            },\r\n            axisPointer: {\r\n                link: { xAxisIndex: 'all' },\r\n                label: {\r\n                    backgroundColor: '#777'\r\n                }\r\n            },\r\n            toolbox: {\r\n                show: false,\r\n                feature: {\r\n                    dataZoom: {\r\n                        yAxisIndex: false\r\n                    },\r\n                    brush: {\r\n                        type: ['lineX', 'clear']\r\n                    }\r\n                }\r\n            },\r\n            visualMap: {\r\n                show: false,\r\n                seriesIndex: 1,\r\n                dimension: 2,\r\n                pieces: [{\r\n                    value: 1,\r\n                    color: downColor\r\n                }, {\r\n                    value: -1,\r\n                    color: upColor\r\n                }]\r\n            },\r\n            grid: [\r\n                {\r\n                    bottom: '30%'\r\n                },\r\n                {\r\n                    height: '15%',\r\n                    bottom: '10%'\r\n                }\r\n            ],\r\n            xAxis: [\r\n                {\r\n                    type: 'category',\r\n                    data: this.data.categoryData,\r\n                    scale: true,\r\n                    boundaryGap: false,\r\n                    axisLine: { onZero: false, lineStyle: { color: '#000' } },\r\n                    splitLine: { show: false },\r\n                    splitNumber: 20,\r\n                    min: 'dataMin',\r\n                    max: 'dataMax',\r\n                    axisLabel: {\r\n                        show: true,\r\n                        textStyle: {\r\n                            fontSize: 14\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    type: 'category',\r\n                    gridIndex: 1,\r\n                    data: this.data.categoryData,\r\n                    scale: true,\r\n                    boundaryGap: false,\r\n                    axisLine: { onZero: false, lineStyle: { color: '#8392A5' } },\r\n                    axisTick: { show: false },\r\n                    splitLine: { show: false },\r\n                    axisLabel: { show: false },\r\n                    splitNumber: 20,\r\n                    min: 'dataMin',\r\n                    max: 'dataMax'\r\n                }\r\n            ],\r\n            yAxis: [{\r\n                scale: true,\r\n                splitArea: {\r\n                    show: true\r\n                },\r\n                axisLine: { lineStyle: { color: '#000' } },\r\n                splitLine: { show: false },\r\n                axisLabel: {\r\n                    show: true,\r\n                    textStyle: {\r\n                        fontSize: 14\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                scale: true,\r\n                gridIndex: 1,\r\n                splitNumber: 2,\r\n                axisLabel: { show: false },\r\n                axisLine: { show: false, lineStyle: { color: '#000' } },\r\n                axisTick: { show: false },\r\n                splitLine: { show: false },\r\n            }\r\n            ],\r\n            dataZoom: [\r\n                {\r\n                    type: 'inside',\r\n                    start: 0,\r\n                    end: 100\r\n                },\r\n                {\r\n                    show: true,\r\n                    type: 'slider',\r\n                    bottom: '2%',\r\n                    start: 0,\r\n                    end: 100,\r\n                    textStyle: {\r\n                        color: '#8392A5'\r\n                    },\r\n                    handleIcon: 'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',\r\n                    handleSize: '80%',\r\n                    dataBackground: {\r\n                        areaStyle: {\r\n                            color: '#8392A5'\r\n                        },\r\n                        lineStyle: {\r\n                            opacity: 0.8,\r\n                            color: '#8392A5'\r\n                        }\r\n                    },\r\n                    handleStyle: {\r\n                        color: '#fff',\r\n                        shadowBlur: 3,\r\n                        shadowColor: 'rgba(0, 0, 0, 0.6)',\r\n                        shadowOffsetX: 2,\r\n                        shadowOffsetY: 2\r\n                    }\r\n                }\r\n            ],\r\n            series: [\r\n                {\r\n                    name: 'Day',\r\n                    type: 'candlestick',\r\n                    data: this.data.values,\r\n                    itemStyle: {\r\n                        color: upColor,\r\n                        color0: downColor,\r\n                        borderColor: upBorderColor,\r\n                        borderColor0: downBorderColor\r\n                    },\r\n                    markPoint:\r\n                    {\r\n                        label: {\r\n                            normal: {\r\n                                formatter: function (param) {\r\n                                    if (typeof (param) === 'number') {\r\n                                        return param != null ? Math.round(param.value) : '';\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        data: [\r\n                            {\r\n                                name: 'highest value',\r\n                                type: 'max',\r\n                                valueDim: 'highest',\r\n                                symbolOffset: [0, -30],\r\n                                itemStyle: {\r\n                                    color: '#FCAE1E'\r\n                                }\r\n                            },\r\n                            {\r\n                                name: 'lowest value',\r\n                                type: 'min',\r\n                                valueDim: 'lowest',\r\n                                symbolOffset: [0, -30],\r\n                                itemStyle: {\r\n                                    color: '#FCAE1E'\r\n                                }\r\n                            },\r\n                            // {\r\n                            //     name: 'average value on close',\r\n                            //     type: 'average',\r\n                            //     valueDim: 'close',\r\n                            //     symbolOffset: [0, -20]\r\n                            // }\r\n                        ],\r\n                        tooltip: {\r\n                            formatter: ((param) => param.name + '<br>' + (param.data.coord || ''))\r\n                        }\r\n                    },\r\n                    markLine: {\r\n                        symbol: ['none', 'none'],\r\n                        lineStyle: {\r\n                            color: downColor\r\n                        },\r\n                        data: [\r\n                            [\r\n                                {\r\n                                    name: 'from lowest to highest',\r\n                                    type: 'min',\r\n                                    valueDim: 'lowest',\r\n                                    symbol: 'circle',\r\n                                    symbolSize: 10,\r\n                                    label: {\r\n                                        show: false\r\n                                    },\r\n                                    emphasis: {\r\n                                        label: {\r\n                                            show: false\r\n                                        }\r\n                                    }\r\n                                },\r\n                                {\r\n                                    type: 'max',\r\n                                    valueDim: 'highest',\r\n                                    symbol: 'circle',\r\n                                    symbolSize: 10,\r\n                                    label: {\r\n                                        show: false\r\n                                    },\r\n                                    emphasis: {\r\n                                        label: {\r\n                                            show: false\r\n                                        }\r\n                                    }\r\n                                }\r\n                            ],\r\n                            {\r\n                                name: 'min line on close',\r\n                                type: 'min',\r\n                                valueDim: 'close'\r\n                            },\r\n                            {\r\n                                name: 'max line on close',\r\n                                type: 'max',\r\n                                valueDim: 'close'\r\n                            }\r\n                        ]\r\n                    }\r\n                },\r\n                {\r\n                    name: 'Volume',\r\n                    type: 'bar',\r\n                    xAxisIndex: 1,\r\n                    yAxisIndex: 1,\r\n                    data: this.data.volumes\r\n                }\r\n\r\n            ]\r\n        };\r\n\r\n        // If resolution !== 'D' skip ARK history mark points and MA lines\r\n        if (this.state.figureRangeButtonConfigs.find(x => x.value === this.state.candlestickDaysRange).resolution !== 'D') {\r\n            return option;\r\n        }\r\n\r\n        // add MA lines according to candlestickDaysRange\r\n        if (this.state.candlestickDaysRange >= 10) {\r\n            option.series.push({\r\n                    name: 'MA5',\r\n                    type: 'line',\r\n                    data: this.calculateMA(5),\r\n                    smooth: true,\r\n                    lineStyle: {\r\n                        opacity: 0.5\r\n                    },\r\n                    itemStyle: {\r\n                        color: '#0000FF'\r\n                    }\r\n            });\r\n            option.legend.data.push('MA5');\r\n        }\r\n        if (this.state.candlestickDaysRange >= 20) {\r\n            option.series.push({\r\n                    name: 'MA10',\r\n                    type: 'line',\r\n                    data: this.calculateMA(10),\r\n                    smooth: true,\r\n                    lineStyle: {\r\n                        opacity: 0.5\r\n                    },\r\n                    itemStyle: {\r\n                        color: '#FFAE19'\r\n                    }\r\n            });\r\n            option.legend.data.push('MA10');\r\n        }\r\n        if (this.state.candlestickDaysRange >= 40) {\r\n            option.series.push({\r\n                name: 'MA20',\r\n                type: 'line',\r\n                data: this.calculateMA(20),\r\n                smooth: true,\r\n                lineStyle: {\r\n                    opacity: 0.5\r\n                },\r\n                itemStyle: {\r\n                    color: '#FF00FF',\r\n                }\r\n            });\r\n            option.legend.data.push('MA20');\r\n        }\r\n\r\n        // handle mark point for BUY/SELL from ARK\r\n        const filteredArkData = arkData.filter(x => x.Ticker === this.state.figureTitle);\r\n        if (!filteredArkData || filteredArkData.length === 0) {\r\n            return option;\r\n        }\r\n\r\n        const groupMap = _.groupBy(filteredArkData, 'Date');\r\n        for (let date in groupMap) {\r\n            const dataArrayInDate = groupMap[date];\r\n            const dataInProps = this.state.massagedData.find(m => m[0] === dataArrayInDate[0].Date);\r\n            if (!(dataInProps && dataInProps[4])) {\r\n                continue;\r\n            }\r\n\r\n            const buyCount = dataArrayInDate.filter(x => x.Direction === 'Buy').length;\r\n            const sellCount = dataArrayInDate.length - buyCount;\r\n\r\n            if (buyCount === 0 || sellCount === 0) {\r\n                let pointText = '';\r\n                if (buyCount === 0) {\r\n                    pointText = sellCount === 1\r\n                        ? `${dataArrayInDate[0].Direction}`\r\n                        : `Sell\\nX${sellCount}`;\r\n                } else if (sellCount === 0) {\r\n                    pointText = buyCount === 1\r\n                        ? `${dataArrayInDate[0].Direction}`\r\n                        : `Buy\\nX${buyCount}`;\r\n                }\r\n\r\n                option.series[0].markPoint.data.push({\r\n                    name: `${dataArrayInDate[0].Date} ${dataArrayInDate[0].Direction}`,\r\n                    coord: [dataArrayInDate[0].Date, dataInProps[4]],\r\n                    value: pointText,\r\n                    itemStyle: {\r\n                        color: buyCount === 0\r\n                            ? '#FF5000'\r\n                            : '#00C805'\r\n                    }\r\n                })\r\n            } else {\r\n                // have buyCount > 0 and sellCount > 0\r\n                option.series[0].markPoint.data.push({\r\n                    name: `${dataArrayInDate[0].Date} Buy`,\r\n                    coord: [dataArrayInDate[0].Date, dataInProps[4]],\r\n                    value: `Buy\\nX${buyCount}`,\r\n                    itemStyle: {\r\n                        color: '#00C805'\r\n                    }\r\n                })\r\n\r\n                option.series[0].markPoint.data.push({\r\n                    name: `${dataArrayInDate[0].Date} Sell`,\r\n                    coord: [dataArrayInDate[0].Date, dataInProps[4] * 1.1],\r\n                    value: `Sell\\n${sellCount}`,\r\n                    itemStyle: {\r\n                        color: '#FF5000'\r\n                    }\r\n                })\r\n            }\r\n        }\r\n        return option;\r\n    }\r\n\r\n    handleCandlestickDaysRangeChange = (event, newValue) => {\r\n        if (newValue !== this.state.candlestickDaysRange && this.state.massagedData.length > 0) {\r\n            this.setState({ candlestickDaysRange: newValue });\r\n            this.getCandleData(this.state.ticker, newValue);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        let subComponent;\r\n        if (this.state.isFigureLoading === true) {\r\n            subComponent =\r\n                <div className='loader-wrapper'>\r\n                    <CircularProgress />\r\n                </div>\r\n        } else if (this.state.massagedData.length > 0) {\r\n            // const fullRangePercentage = this.state.massagedData[this.state.massagedData.length - 1][2] / this.state.massagedData.data[0][2] - 1;\r\n            // const halfRangePercentage = this.state.massagedData[this.state.massagedData.length - 1][2] / this.state.massagedData.data[Math.round((this.state.massagedData.data.length - 1) / 2)][2] - 1;\r\n\r\n            // let fullRangeChange = (fullRangePercentage < 0 ? \"\" : \"+\") + (fullRangePercentage * 100).toFixed(2) + '%'\r\n            // let halfRangeChange = (halfRangePercentage < 0 ? \"\" : \"+\") + (halfRangePercentage * 100).toFixed(2) + '%'\r\n\r\n            subComponent =\r\n                <div>\r\n                    {/* <div className=\"highlights\">\r\n                        <div><p>Full range price change: {fullRangeChange}</p></div>\r\n                        <div><p>Half range price change: {halfRangeChange}</p></div>\r\n                    </div> */}\r\n\r\n                    <ReactEcharts\r\n                        option={this.getOption()}\r\n                        notMerge={true}\r\n                        lazyUpdate={true}\r\n                        style={{ height: '400px', width: '100%' }}\r\n                    />\r\n\r\n                    <Grid container justify=\"center\" alignItems=\"center\">\r\n                        <ToggleButtonGroup\r\n                            className=\"toggle-button-group\"\r\n                            value={this.state.candlestickDaysRange}\r\n                            exclusive\r\n                            onChange={this.handleCandlestickDaysRangeChange}\r\n                            aria-label=\"figure-range-button-group\"\r\n                        >\r\n                            {this.state.figureRangeButtonConfigs.map(button =>\r\n                                <ToggleButton key={button.id} value={button.value} aria-label={`toggle-button-${button.id}`}>{button.text}</ToggleButton>\r\n                            )}\r\n                        </ToggleButtonGroup>\r\n                    </Grid>\r\n                </div>\r\n        } else {\r\n            subComponent =\r\n                <div className=\"chart-placeholder\">\r\n                    <p>\r\n                        Search Any Ticker/Tap Any Card/Tap Any Row\r\n                        <br></br>\r\n                        Candlestick Chart Will Display Below\r\n                    </p>\r\n                    <svg width=\"3em\" height=\"3em\" viewBox=\"0 0 16 16\" className=\"bi bi-chevron-double-down\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                        <path d=\"M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z\" />\r\n                        <path d=\"M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z\" />\r\n                    </svg>\r\n                </div>\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                {subComponent}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default StockFigure;"]},"metadata":{},"sourceType":"module"}